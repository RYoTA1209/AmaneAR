<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.0.1/dist/aframe-extras.min.js"></script>
    <script src="scripts/inflate.min.js"></script>
    <script src="https://raw.githack.com/jeromeetienne/AR.js/2.0.8/aframe/build/aframe-ar.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.1.1/howler.min.js"></script>

    <title>AMANE AR</title>
    <script>
        let audio = new Howl({
            src: ['./src/BGM.mp3']
        });

        AFRAME.registerComponent('registerevents', {
            init: function () {
                var marker = this.el;

                // マーカーを検出したイベントの登録
                marker.addEventListener('markerFound', function () {
                    var markerId = marker.id;
                    console.log('markerFound', markerId);
                    audio.play();
                });

                // マーカーを見失ったイベントの登録
                marker.addEventListener('markerLost', function () {
                    var markerId = marker.id;
                    console.log('markerLost', markerId);
                    audio.pause();
                    audio.currentTime = 0;
                });
            }
        });
    </script>

</head>

<body>

    <a-scene embedded arjs="debugUIEnabled:false;">
        <!-- マーカーを登録（プリセットされている「hiro」マーカー） -->
        <a-marker preset="hiro" id="amane" registerevents>
            <a-entity fbx-model="src:url(models/torch/source/Torch.fbx)" scale="0.01 0.01 0.01" position="1 0 -1">
            </a-entity>
            <a-entity fbx-model="src:url(models/torch/source/Torch.fbx)" scale="0.01 0.01 0.01" position="0 0 -1">
            </a-entity>
            <a-entity fbx-model="src:url(models/torch/source/Torch.fbx)" scale="0.01 0.01 0.01" position="-1 0 -1">
            </a-entity>

            <a-entity fbx-model="src: url(amane.fbx);" animation-mixer="clip:*;loop:repeat;" scale="0.005 0.005 0.005"
                position="0 0 0">
            </a-entity>
        </a-marker>

        <!-- AR用のカメラを置く -->
        <a-entity camera></a-entity>
    </a-scene>


</body>

</html>